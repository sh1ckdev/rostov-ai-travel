# üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è —Å Google Maps –Ω–∞ –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç—ã

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ –∏–∑–º–µ–Ω–µ–Ω–æ

### Backend (–ü–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤!)

#### 1. **back/services/map-service.js**
- ‚úÖ –ó–∞–º–µ–Ω–µ–Ω—ã –≤—Å–µ –≤—ã–∑–æ–≤—ã Google Maps API –Ω–∞ –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç—ã API
- ‚úÖ –ì–µ–æ–∫–æ–¥–µ—Ä: `geocode-maps.yandex.ru`
- ‚úÖ –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è: `api.routing.yandex.net`
- ‚úÖ –ü–æ–∏—Å–∫ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π: `search-maps.yandex.ru`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Ç–∏–ø–æ–≤ Yandex –≤ –Ω–∞—à–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã —Ñ–æ—Ä–º–∞—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

#### 2. **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**
- ‚ùå –£–¥–∞–ª–µ–Ω–∞: `GOOGLE_MAPS_API_KEY`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞: `YANDEX_MAPS_API_KEY`
- –û–±–Ω–æ–≤–ª–µ–Ω—ã —Ñ–∞–π–ª—ã:
  - `env.production`
  - `docker-compose.yml`

#### 3. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**
- ‚úÖ `YANDEX_MAPS_SETUP.md` - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –ø–æ–ª—É—á–µ–Ω–∏—é API –∫–ª—é—á–∞
- ‚úÖ `DEPLOY_INSTRUCTIONS.md` - –û–±–Ω–æ–≤–ª–µ–Ω—ã –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –¥–µ–ø–ª–æ—é
- ‚úÖ `MIGRATION_TO_YANDEX_MAPS.md` - –≠—Ç–æ—Ç —Ñ–∞–π–ª

### Frontend (–¢—Ä–µ–±—É–µ—Ç—Å—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)

> **‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ**: –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è —á–∞—Å—Ç—å –ø–æ–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Google Maps –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã.
> –î–ª—è –ø–æ–ª–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±–Ω–æ–≤–∏—Ç—å React Native –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã.

#### –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å react-native-yamap**
   ```bash
   cd client
   npm install react-native-yamap
   ```

2. **–û–±–Ω–æ–≤–∏—Ç—å MapView –∫–æ–º–ø–æ–Ω–µ–Ω—Ç**
   - –ó–∞–º–µ–Ω–∏—Ç—å react-native-maps –Ω–∞ react-native-yamap
   - –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å props –∏ callbacks

3. **–û–±–Ω–æ–≤–∏—Ç—å DirectionsService**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Yandex API —á–µ—Ä–µ–∑ –±–µ–∫–µ–Ω–¥ (—É–∂–µ –≥–æ—Ç–æ–≤–æ!)

4. **–û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é**
   - Android: –¥–æ–±–∞–≤–∏—Ç—å API –∫–ª—é—á –≤ AndroidManifest.xml
   - iOS: –¥–æ–±–∞–≤–∏—Ç—å API –∫–ª—é—á –≤ Info.plist

## üìã –°—Ä–∞–≤–Ω–µ–Ω–∏–µ API

### –ì–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ

**Google Maps:**
```javascript
GET https://maps.googleapis.com/maps/api/geocode/json?address=...&key=KEY
```

**–Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç—ã:**
```javascript
GET https://geocode-maps.yandex.ru/1.x/?geocode=...&apikey=KEY&format=json
```

### –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è

**Google Maps:**
```javascript
GET https://maps.googleapis.com/maps/api/directions/json?origin=...&destination=...&key=KEY
```

**–Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç—ã:**
```javascript
GET https://api.routing.yandex.net/v2/route?waypoints=...&apikey=KEY
```

### –ü–æ–∏—Å–∫ –º–µ—Å—Ç

**Google Maps:**
```javascript
GET https://maps.googleapis.com/maps/api/place/nearbysearch/json?location=...&radius=...&key=KEY
```

**–Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç—ã:**
```javascript
GET https://search-maps.yandex.ru/v1/?text=...&ll=...&spn=...&apikey=KEY
```

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –æ—Ç–ª–∏—á–∏—è

| –ü–∞—Ä–∞–º–µ—Ç—Ä | Google Maps | –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç—ã |
|----------|-------------|--------------|
| –§–æ—Ä–º–∞—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç | lat,lng | lng,lat |
| –ü–∞—Ä–∞–º–µ—Ç—Ä –∫–ª—é—á–∞ | `key` | `apikey` |
| –†–µ–∂–∏–º—ã –º–∞—Ä—à—Ä—É—Ç–∞ | driving, walking, bicycling, transit | auto, pedestrian, bicycle, masstransit |
| –Ø–∑—ã–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é | English | –†—É—Å—Å–∫–∏–π |
| –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ª–∏–º–∏—Ç | $200/–º–µ—Å—è—Ü | 25,000 –∑–∞–ø—Ä–æ—Å–æ–≤/–¥–µ–Ω—å |

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ü–æ–ª—É—á–∏—Ç–µ API –∫–ª—é—á –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç

–°–º. –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –≤ `YANDEX_MAPS_SETUP.md`

### 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–õ–æ–∫–∞–ª—å–Ω–æ (.env):**
```bash
YANDEX_MAPS_API_KEY=abcdef12-3456-7890-abcd-ef1234567890
```

**–í Dokploy:**
–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞.

### 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ backend

```bash
# –õ–æ–∫–∞–ª—å–Ω–æ
docker-compose down
docker-compose up -d --build

# –í Dokploy
–ù–∞–∂–º–∏—Ç–µ "Redeploy" –≤ –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
```

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### –¢–µ—Å—Ç –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è:
```bash
curl "http://localhost:5000/api/map/geocode?address=–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É"
```

–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:
```json
{
  "success": true,
  "data": {
    "latitude": 47.222078,
    "longitude": 39.720358,
    "formattedAddress": "–†–æ—Å—Å–∏—è, –†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É",
    "placeId": "..."
  }
}
```

### –¢–µ—Å—Ç –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏:
```bash
curl "http://localhost:5000/api/map/directions?originLat=47.222078&originLng=39.720358&destLat=47.235100&destLng=39.712600&mode=driving"
```

## üö® –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **Yandex Router API v2** - —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–ª–∞—Ç–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞ –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
   - –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Static API –∏–ª–∏ JavaScript API

2. **–ü–æ–∏—Å–∫ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π** - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å Google Places
   - –ù–µ—Ç —Ä–µ–π—Ç–∏–Ω–≥–æ–≤
   - –ù–µ—Ç —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
   - –ú–µ–Ω—å—à–µ –¥–µ—Ç–∞–ª–µ–π

3. **–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤ –¥—Ä—É–≥–æ–º –ø–æ—Ä—è–¥–∫–µ**
   - –ù—É–∂–Ω–∞ –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏
   - –£–∂–µ —É—á—Ç–µ–Ω–æ –≤ map-service.js

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ö–µ—à–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è**
   ```javascript
   // –°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤ –±–∞–∑—É –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ
   // –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏—Ö –ø–æ–≤—Ç–æ—Ä–Ω–æ
   ```

2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ debounce –¥–ª—è –ø–æ–∏—Å–∫–∞**
   ```javascript
   // –ù–µ –æ—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ –∑–∞–ø—Ä–æ—Å –ø—Ä–∏ –∫–∞–∂–¥–æ–º –≤–≤–æ–¥–µ —Å–∏–º–≤–æ–ª–∞
   ```

3. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**
   - –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ Yandex
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–ª–µ—Ä—Ç—ã –ø—Ä–∏ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–∏ –∫ –ª–∏–º–∏—Ç–∞–º

4. **Fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏—è**
   ```javascript
   // –ï—Å–ª–∏ Yandex API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
   // –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –±–∞–∑—ã –∏–ª–∏ –∫–µ—à
   ```

## üìä –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç—ã

‚úÖ **–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –ª–∏–º–∏—Ç—ã** - –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤
‚úÖ **–õ–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** - –ª—É—á—à–µ –∑–Ω–∞–µ—Ç –†–æ—Å—Å–∏—é –∏ –°–ù–ì
‚úÖ **–†—É—Å—Å–∫–∏–π —è–∑—ã–∫** - –∏–∑ –∫–æ—Ä–æ–±–∫–∏
‚úÖ **–ù–µ—Ç –±–∏–ª–ª–∏–Ω–≥–∞** - –¥–æ –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è –ª–∏–º–∏—Ç–æ–≤
‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º** - –ø—Ä–æ—â–µ —Ä–∞–∑–±–∏—Ä–∞—Ç—å—Å—è

## üîÑ –ü–ª–∞–Ω –¥–∞–ª—å–Ω–µ–π—à–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π

- [x] –û–±–Ω–æ–≤–∏—Ç—å backend API
- [x] –ó–∞–º–µ–Ω–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- [x] –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- [ ] –û–±–Ω–æ–≤–∏—Ç—å React Native –∫–ª–∏–µ–Ω—Ç (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ endpoints
- [ ] –ó–∞–¥–µ–ø–ª–æ–∏—Ç—å –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

**–ü—Ä–æ–±–ª–µ–º—ã —Å API:**
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç](https://yandex.ru/dev/maps/)
- [–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç](https://developer.tech.yandex.ru/)
- [–§–æ—Ä—É–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤](https://yandex.ru/dev/maps/forum/)

**–ü—Ä–æ–±–ª–µ–º—ã —Å –±–µ–∫–µ–Ω–¥–æ–º:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker-compose logs backend`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ API –∫–ª—é—á –∞–∫—Ç–∏–≤–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–∏–º–∏—Ç—ã –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ

