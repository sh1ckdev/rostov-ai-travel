# üìù –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é –Ω–∞ Dokploy

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ:

### 1. –£–ø—Ä–æ—â–µ–Ω docker-compose.yml
- ‚ùå –£–¥–∞–ª–µ–Ω –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π —Å–µ—Ä–≤–∏—Å (rostov-ai-travel-client)
- ‚ùå –£–¥–∞–ª–µ–Ω nginx
- ‚ùå –£–¥–∞–ª–µ–Ω redis –∏ redis-commander
- ‚ùå –£–¥–∞–ª–µ–Ω mongo-express
- ‚úÖ –û—Å—Ç–∞–≤–ª–µ–Ω—ã —Ç–æ–ª—å–∫–æ: **backend** –∏ **mongo**

### 2. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω Dockerfile
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω curl –¥–ª—è healthcheck
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –ª–æ–≥–æ–≤
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ npm –ø–∞–∫–µ—Ç–æ–≤
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω healthcheck

### 3. –°–æ–∑–¥–∞–Ω .dockerignore
- –ò—Å–∫–ª—é—á–µ–Ω—ã node_modules, –ª–æ–≥–∏, —Ç–µ—Å—Ç—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Å–±–æ—Ä–∫–∏

### 4. –û–±–Ω–æ–≤–ª–µ–Ω env.production
- –£–±—Ä–∞–Ω—ã –Ω–µ–Ω—É–∂–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (Redis, Mongo Express)
- –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏

## üöÄ –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –¥–ª—è –¥–µ–ø–ª–æ—è:

### 1. –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
```bash
git add .
git commit -m "Fix docker-compose for backend-only deployment"
git push
```

### 2. –í Dokploy –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```
JWT_ACCESS_SECRET=–≤–∞—à-—Å–µ–∫—Ä–µ—Ç–Ω—ã–π-–∫–ª—é—á-access
JWT_REFRESH_SECRET=–≤–∞—à-—Å–µ–∫—Ä–µ—Ç–Ω—ã–π-–∫–ª—é—á-refresh
TWOGIS_API_KEY=–≤–∞—à-2gis-api-–∫–ª—é—á
OPENAI_API_KEY=–≤–∞—à-openai-–∫–ª—é—á (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
NODE_ENV=production
PORT=5000
CORS_ORIGIN=*
```

> **üó∫Ô∏è –í–∞–∂–Ω–æ**: –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è `TWOGIS_API_KEY` —Å–º. –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –≤ —Ñ–∞–π–ª–µ `TWOGIS_SETUP.md`

### 3. –í Dokploy:
- **–¢–∏–ø –ø—Ä–æ–µ–∫—Ç–∞**: Docker Compose
- **–ü—É—Ç—å –∫ docker-compose.yml**: `./docker-compose.yml` (–≤ –∫–æ—Ä–Ω–µ)
- **Build context**: `./` (–∫–æ—Ä–µ–Ω—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è)

### 4. –ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–µ–ø–ª–æ–π –≤ Dokploy

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç:

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã:
- **Backend API**: http://–≤–∞—à-–¥–æ–º–µ–Ω:5000
- **MongoDB**: –≤–Ω—É—Ç—Ä–∏ Docker —Å–µ—Ç–∏ (–Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑–≤–Ω–µ)

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã:
```bash
curl http://–≤–∞—à-–¥–æ–º–µ–Ω:5000/api/test
```

–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å:
```json
{
  "message": "Backend is working!",
  "timestamp": "...",
  "ip": "...",
  "userAgent": "..."
}
```

## üîß –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–µ—Ä–≤–∏—Å–æ–≤:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   backend       ‚îÇ  Port 5000
‚îÇ  (Node.js API)  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚îÇ connects to
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ     mongo       ‚îÇ  Port 27017
‚îÇ   (Database)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üêõ –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫:

### –û—à–∏–±–∫–∞: "service not found"
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ! –¢–µ–ø–µ—Ä—å —Å–µ—Ä–≤–∏—Å –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–æ `backend`, –∞ –Ω–µ `rostov-ai-travel-client`

### –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ Dokploy
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Ñ–∞–π–ª—ã –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã –≤ Git

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è
- MongoDB –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è Docker Compose
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `DB_URL=mongodb://mongo:27017/rostov-ai-travel`

### CORS –æ—à–∏–±–∫–∏
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ `CORS_ORIGIN=*` (—Ä–∞–∑—Ä–µ—à–∞–µ—Ç –≤—Å–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏)
- –ü–æ–∑–∂–µ –º–æ–∂–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –¥–æ–º–µ–Ω–∞–º–∏

## üì± –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –±–µ–∫–µ–Ω–¥–∞, –≤ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∏–∑–º–µ–Ω–∏—Ç–µ:

**client/constants/http.ts:**
```typescript
const getBaseURL = () => {
  if (__DEV__) {
    return 'http://–≤–∞—à-–¥–æ–º–µ–Ω:5000/api';
  }
  return 'http://–≤–∞—à-–¥–æ–º–µ–Ω:5000/api';
};
```

## üó∫Ô∏è –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è 2GIS

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **2GIS API** –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–∞—Ä—Ç–∞–º–∏ –∏ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–µ–π:

### Backend (‚úÖ –≥–æ—Ç–æ–≤–æ):
- –ì–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–¥—Ä–µ—Å–æ–≤
- –ü–æ–∏—Å–∫ –º–µ—Å—Ç —Ä—è–¥–æ–º
- –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–æ–≤
- –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–æ–º–ø–∞–Ω–∏—è—Ö

### Frontend (—Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞):
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É 2GIS:
   ```bash
   npm install @2gis/mapgl-native
   ```

2. –î–æ–±–∞–≤–∏—Ç—å API –∫–ª—é—á –≤ –∫–ª–∏–µ–Ω—Ç

3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å MapGL –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞—Ä—Ç

–ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. `TWOGIS_SETUP.md`

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1. ‚úÖ –ó–∞–¥–µ–ø–ª–æ–∏—Ç—å –±–µ–∫–µ–Ω–¥
2. üîÑ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –¥–æ–º–µ–Ω (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
3. üîí –ù–∞—Å—Ç—Ä–æ–∏—Ç—å SSL/HTTPS (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, —á–µ—Ä–µ–∑ Dokploy)
4. üì± –û–±–Ω–æ–≤–∏—Ç—å API_URL –≤ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
5. üß™ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ endpoints

## üí° –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:

–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –≤ Dokploy:
- –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø—Ä–æ–µ–∫—Ç ‚Üí Logs
- –í—ã–±–µ—Ä–∏—Ç–µ —Å–µ—Ä–≤–∏—Å `backend`

–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å:
- –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø—Ä–æ–µ–∫—Ç ‚Üí Services ‚Üí backend
- –ù–∞–∂–º–∏—Ç–µ "Restart"

–û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥:
- –°–¥–µ–ª–∞–π—Ç–µ push –≤ GitHub
- Dokploy –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å–æ–±–µ—Ä–µ—Ç –ø—Ä–æ–µ–∫—Ç (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω auto-deploy)

